{% extends "account/base.html" %}
{% load i18n %}
{% block account_content %}
<div class="text-center mb-4">
    <div class="display-1 text-primary opacity-25 mb-3">
        <i class="bi bi-shield-lock-fill"></i>
    </div>
    <h2 class="fw-bold mb-2">{% if token_fail %}{% trans "Bad Token" %}{% else %}{% trans "Change Password" %}{% endif %}</h2>
    {% if token_fail %}
        <p class="text-muted small">{% trans "The password reset link was invalid, possibly because it has already been used.  Please request a new password reset." %}</p>
    {% else %}
        <p class="text-muted small">{% trans "Enter your new password below." %}</p>
    {% endif %}
</div>

{% if token_fail %}
    <div class="d-grid mt-4">
        <a href="{% url 'account_reset_password' %}" class="btn btn-primary btn-lg py-3 fw-bold">{% trans "New Password Reset" %}</a>
    </div>
{% else %}
    <form method="POST" action="{{ request.path }}" class="password_reset">
        {% csrf_token %}
        
        {% if form.non_field_errors %}
        <div class="alert alert-danger mb-4">
            {% for error in form.non_field_errors %}
            <div class="small">{{ error }}</div>
            {% endfor %}
        </div>
        {% endif %}

        {% for field in form %}
        <div class="mb-3">
            <label class="form-label text-muted small fw-bold">{{ field.label }}</label>
            <input type="{{ field.field.widget.input_type }}" 
                   name="{{ field.name }}"
                   class="form-control form-control-lg {% if field.errors %}is-invalid{% endif %}"
                   {% if field.field.required %}required{% endif %}>
            {% if field.errors %}
            <div class="invalid-feedback">
                {{ field.errors.0 }}
            </div>
            {% endif %}
            {% if field.help_text %}
            <div class="form-text text-muted small">{{ field.help_text }}</div>
            {% endif %}
        </div>
        {% endfor %}

        <div class="d-grid mt-4">
            <button type="submit" class="btn btn-primary btn-lg py-3 fw-bold">{% trans "Change Password" %}</button>
        </div>
    </form>
{% endif %}
{% endblock %}
